{"ast":null,"code":"import _objectSpread from\"C:/Users/Administrator/Desktop/bika/bika/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from\"react\";import{Box,Typography,Button,Paper,Grid,Breadcrumbs,Link,Modal,TextField,MenuItem,IconButton,Dialog,DialogTitle,DialogContent,DialogActions}from\"@mui/material\";import{Add as AddIcon,Close as CloseIcon,Folder as FolderIcon,InsertDriveFile as FileIcon,CreateNewFolder as NewFolderIcon}from\"@mui/icons-material\";import{tokens}from\"../../theme/theme\";// Types\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";// Mock document types and fields\nconst documentTypes=[{id:\"invoice\",name:\"Invoice\",fields:[\"Invoice Number\",\"Date\",\"Amount\"]},{id:\"contract\",name:\"Contract\",fields:[\"Contract Name\",\"Start Date\",\"End Date\"]},{id:\"report\",name:\"Report\",fields:[\"Report Title\",\"Author\"]}];// Mock folder/document structure\nconst initialFolders=[{id:1,name:\"Documents\",folders:[{id:4,name:\"Subfolder A\",folders:[],documents:[{id:3,name:\"Contract 2024\",type:\"contract\",fields:{\"Contract Name\":\"Service Agreement\",\"Start Date\":\"2024-01-01\",\"End Date\":\"2024-12-31\"},attachment:\"contract2024.pdf\"}]}],documents:[{id:1,name:\"Invoice Jan\",type:\"invoice\",fields:{\"Invoice Number\":\"INV-001\",Date:\"2024-01-10\",Amount:\"1000\"},attachment:\"invoice_jan.pdf\"}]},{id:2,name:\"Images\",folders:[],documents:[]},{id:3,name:\"Projects\",folders:[],documents:[{id:2,name:\"Project Report\",type:\"report\",fields:{\"Report Title\":\"Q1 Progress\",Author:\"Alice\"},attachment:\"q1_report.pdf\"}]}];function findFolderByPath(folders,path){let current=folders;let folder=null;for(const name of path){folder=current.find(f=>f.name===name);if(!folder)return null;current=folder.folders;}return folder||{id:-1,name:\"Root\",folders:folders,documents:[]};}const ArchivalPage=()=>{var _documentTypes$find,_documentTypes$find2;const[folders,setFolders]=useState(initialFolders);const[currentPath,setCurrentPath]=useState([]);const[openUpload,setOpenUpload]=useState(false);const[openNewFolder,setOpenNewFolder]=useState(false);const[selectedType,setSelectedType]=useState(\"\");const[attachment,setAttachment]=useState(null);const[docFields,setDocFields]=useState({});const[newFolderName,setNewFolderName]=useState(\"\");const[viewDoc,setViewDoc]=useState(null);// Use a local type for currentFolder that allows fallback\nconst fallbackFolder={id:-1,name:\"Root\",folders,documents:[]};const currentFolder=currentPath.length===0?fallbackFolder:findFolderByPath(folders,currentPath)||fallbackFolder;// Folder navigation\nconst handleFolderClick=name=>{setCurrentPath([...currentPath,name]);};const handleBack=idx=>{if(typeof idx===\"number\")setCurrentPath(currentPath.slice(0,idx+1));else setCurrentPath([]);};// New Folder\nconst handleCreateFolder=()=>{if(!newFolderName)return;const addFolder=(folders,path)=>{if(path.length===0){folders.push({id:Date.now(),name:newFolderName,folders:[],documents:[]});return folders;}return folders.map(f=>f.name===path[0]?_objectSpread(_objectSpread({},f),{},{folders:addFolder(f.folders,path.slice(1))}):f);};setFolders(prev=>addFolder([...prev],currentPath));setNewFolderName(\"\");setOpenNewFolder(false);};// Upload Document\nconst handleTypeChange=event=>{setSelectedType(event.target.value);setDocFields({});};const handleFieldChange=(field,value)=>{setDocFields(prev=>_objectSpread(_objectSpread({},prev),{},{[field]:value}));};const handleFileChange=event=>{if(event.target.files&&event.target.files[0]){setAttachment(event.target.files[0]);}};const handleUpload=event=>{event.preventDefault();if(!selectedType)return;const docType=documentTypes.find(t=>t.id===selectedType);if(!docType)return;const newDoc={id:Date.now(),name:docFields[docType.fields[0]]||\"Untitled Document\",type:selectedType,fields:docFields,attachment:attachment?attachment.name:\"\"};const addDoc=(folders,path)=>{if(path.length===0){folders[0].documents.push(newDoc);return folders;}return folders.map(f=>f.name===path[0]?_objectSpread(_objectSpread({},f),{},{folders:addDoc(f.folders,path.slice(1))}):f);};setFolders(prev=>addDoc([...prev],currentPath.length?currentPath:[folders[0].name]));setOpenUpload(false);setSelectedType(\"\");setDocFields({});setAttachment(null);};// View Document\nconst handleViewDoc=doc=>setViewDoc(doc);const handleCloseViewDoc=()=>setViewDoc(null);return/*#__PURE__*/_jsxs(Box,{width:\"100%\",boxSizing:\"border-box\",p:3,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",fontWeight:600,mb:4,children:\"Document Archival\"}),/*#__PURE__*/_jsxs(Breadcrumbs,{sx:{mb:2},children:[/*#__PURE__*/_jsx(Link,{component:\"button\",variant:\"body1\",onClick:()=>handleBack(-1),sx:{color:tokens.primary.main},children:\"Archival\"}),currentPath.map((name,idx)=>/*#__PURE__*/_jsx(Link,{component:\"button\",variant:\"body1\",onClick:()=>handleBack(idx),sx:{color:tokens.primary.main},children:name},name))]}),/*#__PURE__*/_jsxs(Box,{sx:{display:\"flex\",gap:2,justifyContent:\"flex-end\",mb:2},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(NewFolderIcon,{}),onClick:()=>setOpenNewFolder(true),children:\"New Folder\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",startIcon:/*#__PURE__*/_jsx(AddIcon,{}),onClick:()=>setOpenUpload(true),sx:{bgcolor:tokens.primary.main,\"&:hover\":{bgcolor:tokens.primary.dark}},children:\"Upload Document\"})]}),/*#__PURE__*/_jsx(Paper,{elevation:0,sx:{p:2,backgroundColor:tokens.grey[100],borderRadius:2},children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[currentFolder.folders&&currentFolder.folders.map(folder=>/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:4,children:/*#__PURE__*/_jsx(Paper,{elevation:0,sx:{p:2,cursor:\"pointer\",\"&:hover\":{backgroundColor:tokens.grey[200]}},onClick:()=>handleFolderClick(folder.name),children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",gap:2,children:[/*#__PURE__*/_jsx(FolderIcon,{sx:{color:tokens.secondary.main}}),/*#__PURE__*/_jsx(Typography,{children:folder.name})]})})},folder.id)),currentFolder.documents&&currentFolder.documents.map(doc=>/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:4,children:/*#__PURE__*/_jsx(Paper,{elevation:0,sx:{p:2,cursor:\"pointer\",\"&:hover\":{backgroundColor:tokens.grey[200]}},onClick:()=>handleViewDoc(doc),children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",gap:2,children:[/*#__PURE__*/_jsx(FileIcon,{sx:{color:tokens.primary.main}}),/*#__PURE__*/_jsx(Typography,{children:doc.name})]})})},doc.id))]})}),/*#__PURE__*/_jsxs(Dialog,{open:openNewFolder,onClose:()=>setOpenNewFolder(false),children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Create New Folder\"}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(TextField,{autoFocus:true,margin:\"dense\",label:\"Folder Name\",fullWidth:true,variant:\"outlined\",value:newFolderName,onChange:e=>setNewFolderName(e.target.value)})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setOpenNewFolder(false),children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:handleCreateFolder,variant:\"contained\",children:\"Create\"})]})]}),/*#__PURE__*/_jsx(Modal,{open:openUpload,onClose:()=>setOpenUpload(false),\"aria-labelledby\":\"upload-document-modal\",\"aria-describedby\":\"upload-document-form\",children:/*#__PURE__*/_jsxs(Box,{sx:{position:\"absolute\",top:\"50%\",left:\"50%\",transform:\"translate(-50%, -50%)\",width:400,bgcolor:\"background.paper\",boxShadow:24,p:4,borderRadius:2},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",component:\"h2\",children:\"Upload Document\"}),/*#__PURE__*/_jsx(IconButton,{onClick:()=>setOpenUpload(false),size:\"small\",children:/*#__PURE__*/_jsx(CloseIcon,{})})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleUpload,children:[/*#__PURE__*/_jsx(TextField,{select:true,fullWidth:true,label:\"Document Type\",value:selectedType,onChange:handleTypeChange,margin:\"normal\",required:true,children:documentTypes.map(type=>/*#__PURE__*/_jsx(MenuItem,{value:type.id,children:type.name},type.id))}),selectedType&&((_documentTypes$find=documentTypes.find(t=>t.id===selectedType))===null||_documentTypes$find===void 0?void 0:_documentTypes$find.fields.map(field=>/*#__PURE__*/_jsx(TextField,{label:field,fullWidth:true,margin:\"normal\",value:docFields[field]||\"\",onChange:e=>handleFieldChange(field,e.target.value),required:true},field))),/*#__PURE__*/_jsx(\"input\",{accept:\"image/*,.pdf,.doc,.docx\",style:{display:\"none\"},id:\"attachment-input\",type:\"file\",onChange:handleFileChange}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"attachment-input\",children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",component:\"span\",fullWidth:true,sx:{mt:2},children:\"Select Attachment\"})}),attachment&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{mt:1},children:[\"Selected: \",attachment.name]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",fullWidth:true,sx:{mt:2,bgcolor:tokens.primary.main,\"&:hover\":{bgcolor:tokens.primary.dark}},children:\"Upload\"})]})]})}),/*#__PURE__*/_jsx(Modal,{open:!!viewDoc,onClose:handleCloseViewDoc,\"aria-labelledby\":\"view-document-modal\",\"aria-describedby\":\"view-document-details\",children:/*#__PURE__*/_jsxs(Box,{sx:{position:\"absolute\",top:\"50%\",left:\"50%\",transform:\"translate(-50%, -50%)\",width:400,bgcolor:\"background.paper\",boxShadow:24,p:4,borderRadius:2},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",component:\"h2\",children:viewDoc===null||viewDoc===void 0?void 0:viewDoc.name}),/*#__PURE__*/_jsx(IconButton,{onClick:handleCloseViewDoc,size:\"small\",children:/*#__PURE__*/_jsx(CloseIcon,{})})]}),viewDoc&&/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle1\",sx:{mb:1},children:[\"Type: \",(_documentTypes$find2=documentTypes.find(t=>t.id===viewDoc.type))===null||_documentTypes$find2===void 0?void 0:_documentTypes$find2.name]}),Object.entries(viewDoc.fields).map(_ref=>{let[field,value]=_ref;return/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsxs(\"strong\",{children:[field,\":\"]}),\" \",value]},field);}),/*#__PURE__*/_jsx(Box,{sx:{mt:2},children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Attachment:\"}),\" \",viewDoc.attachment]})})]})]})})]});};export default ArchivalPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}